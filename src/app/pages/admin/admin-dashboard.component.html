<section class="container admin">
  <h1>Admin</h1>
  <div class="bar">
    <a class="btn" routerLink="/admin/orders">View Orders</a>
    <button class="btn" (click)="rehostImages()">Rehost Images</button>
    <button class="btn" (click)="startAdd()">Add Product</button>
    <button class="btn" (click)="admin.logout()" *ngIf="admin.loggedIn()">Logout</button>
  </div>

  <div *ngIf="loading()">Loadingâ€¦</div>
  <div class="error" *ngIf="error()">{{ error() }}</div>

  <table class="table" *ngIf="!loading()">
    <thead><tr><th>Name</th><th>Price</th><th>Category</th><th>Actions</th></tr></thead>
    <tbody>
      <tr *ngFor="let p of products()">
        <td>{{ p.name }}</td>
        <td>{{ p.price | currency:p.currency }}</td>
        <td>{{ p.category }}</td>
        <td>
          <button class="link" (click)="startEdit(p)">Edit</button>
          <button class="link danger" (click)="remove(p)">Delete</button>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="modal" *ngIf="editing">
    <div class="modal-inner">
      <h2>{{ editing && editing.id ? 'Edit' : 'Add' }} Product</h2>
      <form (ngSubmit)="save()" class="form">
        <label>Name <input [(ngModel)]="editing!.name" name="name" required /></label>
        <label>Slug <input [(ngModel)]="editing!.slug" name="slug" required /></label>
        <label>Price <input [(ngModel)]="editing!.price" name="price" type="number" required /></label>
        <label>Currency <input [(ngModel)]="editing!.currency" name="currency" /></label>
        <label>Category <input [(ngModel)]="editing!.category" name="category" /></label>
        <label>Description <textarea [(ngModel)]="editing!.description" name="description" rows="4"></textarea></label>
        <label>Upload Image <input type="file" (change)="onFile($event)" accept="image/*" /></label>
        <div class="actions">
          <button class="btn primary" type="submit">Save</button>
          <button class="btn" type="button" (click)="cancel()">Cancel</button>
        </div>
      </form>
    </div>
  </div>
</section>
